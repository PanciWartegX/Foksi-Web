<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Firebase Connection</title>
</head>
<body>
    <h1>Test Firebase Connection</h1>
    <button onclick="testConnection()">Test Firebase Connection</button>
    <div id="result"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBaEkKJzyohsq6GK5GWygai0q3V0O_MkLY",
            authDomain: "web-foksi-9acb9.firebasestorage.app",
            projectId: "web-foksi-9acb9",
            storageBucket: "web-foksi-9acb9.firebasestorage.app",
            messagingSenderId: "811305636316",
            appId: "1:811305636316:web:42718618e39e56ee203f19",
            measurementId: "G-BN0KBQQMBJ"
        };

        async function testConnection() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Testing Firebase connection...</p>';
            
            try {
                // Initialize Firebase
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                const db = getFirestore(app);
                
                resultDiv.innerHTML += '<p style="color: green;">‚úÖ Firebase initialized successfully!</p>';
                
                // Test Firestore
                try {
                    const testDoc = doc(db, "test", "connection");
                    await setDoc(testDoc, { test: true, timestamp: new Date().toISOString() });
                    resultDiv.innerHTML += '<p style="color: green;">‚úÖ Firestore write successful!</p>';
                    
                    const readDoc = await getDoc(testDoc);
                    resultDiv.innerHTML += `<p style="color: green;">‚úÖ Firestore read successful! Data: ${JSON.stringify(readDoc.data())}</p>`;
                } catch (firestoreError) {
                    resultDiv.innerHTML += `<p style="color: red;">‚ùå Firestore error: ${firestoreError.message}</p>`;
                }
                
                // Test Auth
                const testEmail = `test${Date.now()}@gmail.com`;
                const testPassword = "password123";
                
                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, testEmail, testPassword);
                    resultDiv.innerHTML += `<p style="color: green;">‚úÖ Auth create user successful! UID: ${userCredential.user.uid}</p>`;
                    
                    // Try to sign in
                    await signInWithEmailAndPassword(auth, testEmail, testPassword);
                    resultDiv.innerHTML += '<p style="color: green;">‚úÖ Auth sign in successful!</p>';
                    
                } catch (authError) {
                    resultDiv.innerHTML += `<p style="color: orange;">‚ö†Ô∏è Auth error (might be expected): ${authError.code} - ${authError.message}</p>`;
                }
                
                resultDiv.innerHTML += '<p style="color: green; font-weight: bold;">üéâ All Firebase tests completed!</p>';
                
            } catch (error) {
                resultDiv.innerHTML += `<p style="color: red;">‚ùå Firebase initialization failed: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>